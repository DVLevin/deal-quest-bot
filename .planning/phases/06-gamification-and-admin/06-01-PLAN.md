---
phase: 06-gamification-and-admin
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/webapp/src/features/gamification/components/BadgeWall.tsx
  - packages/webapp/src/features/gamification/components/BadgeCard.tsx
  - packages/webapp/src/pages/Profile.tsx
autonomous: true

must_haves:
  truths:
    - "Badge wall displays all 8 badges in a visual grid"
    - "Earned badges show full-color icons with rarity-colored borders and 'Earned' label"
    - "Locked badges show grayscale silhouettes with criteria description"
    - "Each rarity tier (common, rare, epic, legendary) has distinct visual styling"
  artifacts:
    - path: "packages/webapp/src/features/gamification/components/BadgeWall.tsx"
      provides: "Full badge wall page component with rarity-grouped grid"
      min_lines: 60
    - path: "packages/webapp/src/features/gamification/components/BadgeCard.tsx"
      provides: "Individual badge card with rarity tier styling, earned/locked states"
      min_lines: 50
  key_links:
    - from: "packages/webapp/src/features/gamification/components/BadgeWall.tsx"
      to: "packages/webapp/src/features/profile/hooks/useUserBadges.ts"
      via: "useUserBadges() hook for badge evaluation data"
      pattern: "useUserBadges"
    - from: "packages/webapp/src/features/gamification/components/BadgeCard.tsx"
      to: "packages/webapp/src/shared/data/badges.ts"
      via: "BadgeDefinition and EarnedBadge types, rarity field"
      pattern: "rarity.*common|rare|epic|legendary"
---

<objective>
Build a dedicated Badge Wall component that upgrades the existing Profile badge collection into a richer, rarity-styled visual grid. Earned badges display full-color with rarity accent borders and an "Earned" label. Locked badges display as grayscale silhouettes with criteria hints. Badges are visually distinguished by rarity tier (common, rare, epic, legendary) through border colors, background glow effects, and label styling.

Purpose: GAME-01 (badge wall) and GAME-02 (rarity tiers) -- the gamification engagement layer that makes badge collection feel rewarding.

Output: BadgeWall and BadgeCard components in a new gamification feature folder, integrated into the Profile page replacing or supplementing the existing BadgeCollection.
</objective>

<execution_context>
@/Users/dmytrolevin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dmytrolevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Existing infrastructure to build on:
@packages/webapp/src/shared/data/badges.ts — Badge definitions (8 badges), BadgeCriteria, EarnedBadge type, evaluateBadges()
@packages/webapp/src/features/profile/hooks/useUserBadges.ts — Hook returning allBadges, earned, earnedCount, totalCount
@packages/webapp/src/features/profile/components/BadgeCollection.tsx — Current grid with EarnedBadgeItem/LockedBadgeItem (reference for icon map pattern)
@packages/webapp/src/app/globals.css — Rarity tier oklch colors: --color-rarity-common, --color-rarity-rare, --color-rarity-epic, --color-rarity-legendary
@packages/webapp/src/pages/Profile.tsx — Profile page where BadgeWall will be integrated
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BadgeCard and BadgeWall components</name>
  <files>
    packages/webapp/src/features/gamification/components/BadgeCard.tsx
    packages/webapp/src/features/gamification/components/BadgeWall.tsx
  </files>
  <action>
Create `src/features/gamification/components/` directory structure.

**BadgeCard.tsx** -- A single badge display component with two states:
- **Earned state:** Full-color rarity border (using existing `border-rarity-{tier}` Tailwind classes), rarity-colored icon (using existing `text-rarity-{tier}` classes), badge name below, and a small "Earned" text label. For legendary rarity, add a subtle `shadow-[0_0_8px]` glow using the `--color-rarity-legendary` token. For epic rarity, add a smaller `shadow-[0_0_4px]` glow using `--color-rarity-epic`.
- **Locked state:** `opacity-30` container, `border-surface-secondary` border, grayscale icon, badge name in `text-text-hint`, criteria description text (from badge.description) in `text-[10px] text-text-hint`.

Props: `{ badge: BadgeDefinition; earned: boolean; rarity: 'common' | 'rare' | 'epic' | 'legendary' }`.

Reuse the existing `iconMap` pattern from BadgeCollection.tsx -- import the same lucide icons (Trophy, Flame, Star, Target, Zap, Shield, Gem) and map badge.icon string to LucideIcon component. Use `cn()` from `@/shared/lib/cn` for conditional classes.

Size the badge icon container at `h-14 w-14` (slightly larger than the existing `h-12 w-12` in BadgeCollection) for the dedicated wall view. Icon size: `h-6 w-6`.

Add a rarity label below the badge name: a tiny `text-[10px]` label showing the rarity tier name (e.g., "Common", "Rare", "Epic", "Legendary") styled in the rarity color. Only show this on earned badges.

**BadgeWall.tsx** -- The full badge wall component:
- Import and call `useUserBadges()` from `@/features/profile/hooks/useUserBadges`.
- Header: "Badge Wall" title with earned count (e.g., "3/8").
- Grid layout: `grid grid-cols-3 gap-4` for 3 badges per row on mobile (8 badges = 3 rows).
- Map over `allBadges`, check if each badge exists in `earned` array (by id), render BadgeCard with earned={true/false}.
- Loading state: 8 Skeleton circles in the same grid layout.
- Error state: "Unable to load badges" text.
- Empty state: encouraging message + all badges shown as locked.

Do NOT modify the existing BadgeCollection.tsx in the profile feature (it continues to serve as the compact collection view on the Profile page). BadgeWall is the expanded dedicated view.
  </action>
  <verify>
    TypeScript compiles: `cd packages/webapp && npx tsc --noEmit`
    Verify files exist and have correct imports: grep for "useUserBadges" in BadgeWall.tsx, grep for "iconMap" in BadgeCard.tsx
  </verify>
  <done>BadgeCard renders earned/locked states with rarity-specific styling. BadgeWall shows all 8 badges in a 3-column grid using useUserBadges() data. Both components compile without errors.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate BadgeWall into Profile page</name>
  <files>
    packages/webapp/src/pages/Profile.tsx
  </files>
  <action>
Read the current Profile.tsx to understand its structure. Add the BadgeWall component below the existing BadgeCollection (or replace it, depending on how Profile.tsx currently uses BadgeCollection).

**Integration approach:**
- Import BadgeWall from `@/features/gamification/components/BadgeWall`.
- Add BadgeWall in the Profile page layout, positioned after the stats section and before or replacing the existing BadgeCollection. If BadgeCollection currently exists in Profile.tsx, replace it with BadgeWall since BadgeWall is the upgraded version. If Profile uses BadgeCollection as a compact preview with a "See all" link, keep the compact preview and add BadgeWall as the expanded view (similar to how Dashboard has BadgePreview).
- Based on existing patterns: Profile.tsx likely renders BadgeCollection directly. Replace it with BadgeWall for the richer display.

Do NOT change any other page (Dashboard still uses its own BadgePreview component).
  </action>
  <verify>
    TypeScript compiles: `cd packages/webapp && npx tsc --noEmit`
    Dev server renders: `cd packages/webapp && npx vite build`
  </verify>
  <done>Profile page shows the full BadgeWall with rarity-styled earned/locked badges instead of the simpler BadgeCollection grid.</done>
</task>

</tasks>

<verification>
- `cd packages/webapp && npx tsc --noEmit` passes
- `cd packages/webapp && npx vite build` succeeds
- BadgeWall.tsx imports useUserBadges and renders all 8 badges
- BadgeCard.tsx has distinct styling for common, rare, epic, legendary tiers
- Earned badges show rarity-colored borders and "Earned" label
- Locked badges show grayscale with criteria description
- Profile page imports and renders BadgeWall
</verification>

<success_criteria>
- GAME-01: Badge wall displays all badges in a visual grid with earned and locked states
- GAME-02: Rarity tiers have distinct visual styling (colors, optional glow for epic/legendary)
- Both components use existing useUserBadges() hook and badge definitions (no new data fetching)
- Profile page upgraded from BadgeCollection to BadgeWall
</success_criteria>

<output>
After completion, create `.planning/phases/06-gamification-and-admin/06-01-SUMMARY.md`
</output>
