---
phase: 20-quick-wins-by-prody
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/webapp/src/features/leads/components/LeadList.tsx
  - packages/webapp/src/features/dashboard/components/TodayActionsCard.tsx
autonomous: true

must_haves:
  truths:
    - "Lead list page shows a compact pipeline summary bar with status counts and stale count above the lead cards"
    - "TodayActionsCard shows a celebration message with completed action count when all actions are done for the day"
  artifacts:
    - path: "packages/webapp/src/features/leads/components/LeadList.tsx"
      provides: "Pipeline summary bar with Active/Stale/Closed counts"
      contains: "statusCounts"
    - path: "packages/webapp/src/features/dashboard/components/TodayActionsCard.tsx"
      provides: "Done-for-today celebration message with completed count"
      contains: "All caught up"
  key_links:
    - from: "packages/webapp/src/features/leads/components/LeadList.tsx"
      to: "useLeads hook"
      via: "Computes status counts from existing leads data"
      pattern: "useMemo.*leads"
    - from: "packages/webapp/src/features/dashboard/components/TodayActionsCard.tsx"
      to: "useTodayActions hook"
      via: "Detects zero remaining actions and shows celebration"
      pattern: "actions.*length.*0"
---

<objective>
Add pipeline summary bar to leads page (QW #3) and "Done for Today" celebration (QW #6).

Purpose: Give users instant pipeline awareness without scrolling through cards, and positively reinforce completing daily engagement actions.

Output: Enhanced LeadList with status counts, enhanced TodayActionsCard with completion celebration.
</objective>

<execution_context>
@/Users/dmytrolevin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dmytrolevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/webapp/src/features/leads/components/LeadList.tsx
@packages/webapp/src/features/leads/hooks/useLeads.ts
@packages/webapp/src/features/dashboard/components/TodayActionsCard.tsx
@packages/webapp/src/features/leads/hooks/useTodayActions.ts
@packages/webapp/src/features/leads/types.ts (LEAD_STATUS_CONFIG, status labels)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Pipeline summary bar on leads page</name>
  <files>packages/webapp/src/features/leads/components/LeadList.tsx</files>
  <action>
Add a pipeline summary bar to LeadList, rendered above the lead cards when leads exist:

1. Import `useMemo` from React and `LEAD_STATUS_CONFIG` from `../types`.
2. Add a `useMemo` that computes status counts from the `leads` array:
   ```typescript
   const summary = useMemo(() => {
     if (!leads || leads.length === 0) return null;
     let active = 0;
     let stale = 0;
     let closed = 0;
     const now = Date.now();
     const STALE_MS = 7 * 24 * 60 * 60 * 1000;
     for (const lead of leads) {
       if (lead.status === 'closed_won' || lead.status === 'closed_lost') {
         closed++;
       } else {
         active++;
         const updatedAt = new Date(lead.updated_at ?? lead.created_at ?? 0).getTime();
         if (now - updatedAt > STALE_MS) {
           stale++;
         }
       }
     }
     return { active, stale, closed, total: leads.length };
   }, [leads]);
   ```
3. Render the summary bar above the lead cards (inside the existing `return` where leads are mapped). Use a compact horizontal flex row:
   ```tsx
   {summary && (
     <div className="flex items-center gap-3 rounded-xl bg-surface-secondary/50 px-4 py-2.5 text-xs font-medium">
       <span className="text-text-secondary">{summary.total} leads</span>
       <span className="text-text-hint">|</span>
       <span className="text-accent">{summary.active} Active</span>
       {summary.stale > 0 && (
         <span className="text-warning">{summary.stale} Stale</span>
       )}
       <span className="text-text-hint">{summary.closed} Closed</span>
     </div>
   )}
   ```
4. The summary bar goes inside the existing `<div className="space-y-2">` wrapper, before the `.map()`.
  </action>
  <verify>
TypeScript compiles: `cd packages/webapp && npx tsc --noEmit`.
Grep confirms "statusCounts" or "summary" useMemo in LeadList.tsx.
  </verify>
  <done>
Lead list page shows a compact summary bar at the top: "12 leads | 8 Active | 2 Stale | 2 Closed". Stale count only appears when > 0.
  </done>
</task>

<task type="auto">
  <name>Task 2: "Done for Today" celebration in TodayActionsCard</name>
  <files>packages/webapp/src/features/dashboard/components/TodayActionsCard.tsx</files>
  <action>
Enhance the empty state of TodayActionsCard when the user has completed all their daily actions:

1. The hook `useTodayActions` returns data that may be `[]` (empty) when either (a) no actions exist at all or (b) all actions were completed. The current empty state shows "No actions due today. Great job!" for both cases.

2. To differentiate "all caught up after doing work" from "nothing to do", we need to track completed actions. Since the hook returns only pending/overdue items, we'll enhance the message to be more celebratory. Import `CheckCircle2` and `PartyPopper` from `lucide-react`.

3. Replace the current empty state block (the `if (!actions || actions.length === 0)` block) with a richer celebration:
   ```tsx
   if (!actions || actions.length === 0) {
     return (
       <Card>
         <div className="flex items-center gap-2 text-text-secondary">
           <ListTodo className="h-5 w-5" />
           <span className="text-sm font-medium">Today's Actions</span>
         </div>
         <div className="mt-3 flex items-center gap-3 rounded-xl bg-success/8 p-3">
           <CheckCircle2 className="h-5 w-5 shrink-0 text-success" />
           <div>
             <p className="text-sm font-medium text-text">All caught up!</p>
             <p className="text-xs text-text-hint">
               No actions due today. Keep the momentum going.
             </p>
           </div>
         </div>
       </Card>
     );
   }
   ```

4. Add `CheckCircle2` to the lucide-react import at the top of the file.
  </action>
  <verify>
TypeScript compiles: `cd packages/webapp && npx tsc --noEmit`.
Grep confirms "All caught up" and "CheckCircle2" in TodayActionsCard.tsx.
  </verify>
  <done>
TodayActionsCard shows a green-tinted "All caught up!" celebration card when no actions are due, with encouraging copy. The existing overdue/due-today display is unchanged.
  </done>
</task>

</tasks>

<verification>
1. LeadList.tsx contains a summary bar computing Active/Stale/Closed counts from existing lead data
2. TodayActionsCard.tsx shows a green "All caught up!" celebration when no actions are pending
3. Both components compile without TypeScript errors
4. No new hooks or data fetching -- all computed from existing query data
</verification>

<success_criteria>
- Pipeline summary bar visible at top of lead list with accurate counts
- Stale count only shown when > 0
- "Done for Today" celebration replaces plain empty state in TodayActionsCard
- No new API calls or data dependencies introduced
</success_criteria>

<output>
After completion, create `.planning/phases/20-quick-wins-by-prody/20-02-SUMMARY.md`
</output>
