---
phase: 09-training-experience
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - packages/webapp/src/features/learn/components/TrackSummary.tsx
  - packages/webapp/src/features/learn/components/TrackList.tsx
  - packages/webapp/src/features/dashboard/components/WeakAreasCard.tsx
  - packages/webapp/src/pages/Dashboard.tsx
autonomous: true

must_haves:
  truths:
    - "Learn page displays per-track summary (levels completed, avg score, best score) at the top of each track"
    - "Dashboard highlights weak areas (tracks/difficulties with below-average scores) with a Practice this button"
    - "Practice this button navigates to /train with the appropriate difficulty pre-context"
    - "Weak areas card shows nothing when user has no attempts (graceful empty state)"
    - "Track summary computes stats from existing useTrackProgress data without additional queries"
  artifacts:
    - path: "packages/webapp/src/features/learn/components/TrackSummary.tsx"
      provides: "Per-track stats card: levels completed, avg score, best score"
      exports: ["TrackSummary"]
    - path: "packages/webapp/src/features/dashboard/components/WeakAreasCard.tsx"
      provides: "Dashboard weak areas identification with Practice this CTA"
      exports: ["WeakAreasCard"]
  key_links:
    - from: "packages/webapp/src/features/learn/components/TrackSummary.tsx"
      to: "packages/webapp/src/features/learn/hooks/useTrackProgress.ts"
      via: "Receives LevelWithProgress[] from parent TrackList"
      pattern: "LevelWithProgress"
    - from: "packages/webapp/src/features/dashboard/components/WeakAreasCard.tsx"
      to: "packages/webapp/src/features/train/hooks/useTrainingStats.ts"
      via: "Imports useTrainingStats for difficulty-level weak areas"
      pattern: "import.*useTrainingStats"
    - from: "packages/webapp/src/features/dashboard/components/WeakAreasCard.tsx"
      to: "react-router navigate"
      via: "Practice this button navigates to /train"
      pattern: "navigate.*train"
    - from: "packages/webapp/src/pages/Dashboard.tsx"
      to: "WeakAreasCard"
      via: "Component import and render"
      pattern: "<WeakAreasCard"
---

<objective>
Add per-track completion stats to the Learn page header and a weak areas card to the Dashboard.

Purpose: Users see their learning progress at a glance on the Learn page and get actionable improvement suggestions on the Dashboard with one-tap navigation to practice (TRAIN-V11-02 + TRAIN-V11-03).

Output: TrackSummary component on Learn page, WeakAreasCard component on Dashboard.
</objective>

<execution_context>
@/Users/dmytrolevin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dmytrolevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-training-experience/09-RESEARCH.md
@.planning/phases/09-training-experience/09-01-SUMMARY.md
@packages/webapp/src/features/learn/components/TrackList.tsx
@packages/webapp/src/features/learn/hooks/useTrackProgress.ts
@packages/webapp/src/features/learn/data/tracks.ts
@packages/webapp/src/features/train/hooks/useTrainingStats.ts
@packages/webapp/src/pages/Dashboard.tsx
@packages/webapp/src/features/dashboard/components/QuickActions.tsx
@packages/webapp/src/types/constants.ts
@packages/webapp/src/shared/ui/Card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TrackSummary component and add to TrackList</name>
  <files>
    packages/webapp/src/features/learn/components/TrackSummary.tsx
    packages/webapp/src/features/learn/components/TrackList.tsx
  </files>
  <action>
    1. Create `TrackSummary.tsx`:
       - Import `Card` from `@/shared/ui` and `type LevelWithProgress` from `../hooks/useTrackProgress`.
       - Props: `levels: LevelWithProgress[]`
       - Compute stats from the levels array using a pure function (no hooks needed, data is already fetched by TrackList):
         - `levelsCompleted`: count of levels where `status === 'completed'`
         - `totalLevels`: levels.length
         - `avgScore`: average of `bestScore` across levels where `bestScore > 0` (guard: if none, show 0). Round to nearest integer.
         - `bestScore`: max of `bestScore` across all levels (guard: if none, show 0)
       - Render a Card with a horizontal stat row (flex, gap-4, justify-between):
         ```
         [Levels: 2/4]  [Avg Score: 72]  [Best: 85]
         ```
         Each stat as a vertical stack: label (text-xs text-text-hint) over value (text-sm font-semibold text-text).
       - If all bestScores are 0 (no attempts yet), show a simplified message: "Start learning to track your progress" in text-xs text-text-hint.

    2. Update `TrackList.tsx`:
       - Import `TrackSummary` from `./TrackSummary`.
       - In the success render (after the track name/description `<div>` and before the levels list `<div className="space-y-3">`), add:
         ```
         {levels && <TrackSummary levels={levels} />}
         ```
       - This renders the track summary between the header and the level cards.
  </action>
  <verify>
    TypeScript compiles: `cd packages/webapp && npx tsc --noEmit 2>&1 | head -20`
  </verify>
  <done>
    Learn page shows per-track summary card (levels completed, avg score, best score) between track header and level list. Shows guidance message for users with no attempts.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create WeakAreasCard and add to Dashboard</name>
  <files>
    packages/webapp/src/features/dashboard/components/WeakAreasCard.tsx
    packages/webapp/src/pages/Dashboard.tsx
  </files>
  <action>
    1. Create `WeakAreasCard.tsx`:
       - Import `Card` from `@/shared/ui`, `Button` from `@/shared/ui`, `useNavigate` from `react-router`, `useTrainingStats` from `@/features/train/hooks/useTrainingStats`, `DIFFICULTY_LABELS` from `@/types/constants`, `AlertTriangle` or `Target` from `lucide-react`.
       - Call `useTrainingStats()` to get `avgScoreByDifficulty`, `recommendedDifficulty`, `isLoading`.
       - Compute weak areas from `avgScoreByDifficulty`:
         - For each difficulty (1, 2, 3) where the user has attempts:
           - Compute overall average across all difficulties
           - A difficulty is "weak" if its avg score is below the overall average AND has at least 3 attempts
         - Sort weak areas by avg score ascending (worst first)
         - Take top 3 weak areas
       - Each weak area item: `{ difficulty: number; label: string; avgScore: number; count: number }`
       - If no weak areas found (not enough data or all above average): render nothing (return null). This handles new users gracefully.
       - If loading: render nothing (return null) -- Dashboard already has its own loading states.
       - Render:
         ```
         <Card>
           <h3 className="mb-3 text-sm font-semibold text-text flex items-center gap-2">
             <AlertTriangle className="h-4 w-4 text-warning" />
             Areas to Improve
           </h3>
           {weakAreas.map(area => (
             <div key={area.difficulty} className="flex items-center justify-between py-2">
               <div>
                 <span className="text-sm text-text">{area.label}</span>
                 <span className="ml-2 text-xs text-text-hint">avg {area.avgScore}</span>
               </div>
               <Button
                 variant="ghost"
                 size="sm"
                 onClick={() => navigate('/train')}
               >
                 Practice
               </Button>
             </div>
           ))}
         </Card>
         ```
       - Practice button navigates to `/train`. The user can then select the difficulty manually. (Per research recommendation: stay in TMA, navigate to Train page.)
       - All Button touch targets must be min 44px.

    2. Update `Dashboard.tsx`:
       - Import `WeakAreasCard` from `@/features/dashboard/components/WeakAreasCard`.
       - Add `<WeakAreasCard />` AFTER `<QuickActions />` and BEFORE `<BadgePreview />`:
         ```
         <ProgressCard />
         <QuickActions />
         <WeakAreasCard />      <-- NEW
         <BadgePreview />
         <LeaderboardWidget />
         ```
       - WeakAreasCard handles its own data fetching and empty state internally (renders null when no weak areas).
  </action>
  <verify>
    TypeScript compiles: `cd packages/webapp && npx tsc --noEmit 2>&1 | head -20`
    Build succeeds: `cd packages/webapp && npx vite build 2>&1 | tail -5`
  </verify>
  <done>
    Dashboard shows "Areas to Improve" card with weak difficulty levels and Practice buttons. Card self-hides when no weak areas exist. Learn page shows track completion stats header.
  </done>
</task>

</tasks>

<verification>
1. `cd packages/webapp && npx tsc --noEmit` -- zero type errors
2. `cd packages/webapp && npx vite build` -- production build succeeds
3. Grep for new components: `grep -r "TrackSummary\|WeakAreasCard" packages/webapp/src/ --include="*.tsx"` confirms both are imported and rendered
4. Verify Dashboard composition order: `grep -A5 "QuickActions\|WeakAreasCard\|BadgePreview" packages/webapp/src/pages/Dashboard.tsx` shows correct ordering
5. Verify TrackList has TrackSummary: `grep "TrackSummary" packages/webapp/src/features/learn/components/TrackList.tsx` confirms render
</verification>

<success_criteria>
- TrackSummary shows levels completed (X/Y), avg score, best score computed from LevelWithProgress data
- TrackSummary shows guidance message for users with no attempts
- WeakAreasCard identifies difficulty levels with below-average scores and shows Practice buttons
- WeakAreasCard renders null gracefully when no data or no weak areas
- Dashboard has WeakAreasCard positioned between QuickActions and BadgePreview
- All TypeScript compiles, Vite builds succeed
</success_criteria>

<output>
After completion, create `.planning/phases/09-training-experience/09-02-SUMMARY.md`
</output>
